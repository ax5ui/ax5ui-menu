"use strict";!function(e,t){var i=ax5.util,n=function(){var e,n=this;t&&t.call(this),this.config={theme:"default",iconWidth:22,acceleratorWidth:100,menuBodyPadding:5,direction:"top-left",animateTime:250,items:[]},this.openTimer=null,this.closeTimer=null,this.queue=[],e=this.config,this.init=function(){n.menuId=ax5.getGuid()},this.__getTmpl=function(){return'\n            <div class="ax5-ui-menu {{theme}}">\n                <div class="ax-menu-body">\n                    {{#items}}\n                        {{#divide}}\n                        <div class="ax-menu-item-divide"></div>\n                        {{/divide}}\n                        {{^divide}}\n                        <div class="ax-menu-item" data-menu-item-depth="{{@depth}}" data-menu-item-index="{{@i}}" data-menu-item-path="{{@path}}.{{@i}}">\n                            <span class="ax-menu-item-cell ax-menu-item-icon" style="width:{{cfg.iconWidth}}px;">{{{icon}}}</span>\n                            <span class="ax-menu-item-cell ax-menu-item-label">{{{label}}}</span>\n                            {{#accelerator}}\n                            <span class="ax-menu-item-cell ax-menu-item-accelerator" style="width:{{cfg.acceleratorWidth}}px;"><span class="item-wrap">{{.}}</span></span>\n                            {{/accelerator}}\n                            {{#@hasChild}}\n                            <span class="ax-menu-item-cell ax-menu-item-handle">{{{cfg.icons.arrow}}}</span>\n                            {{/@hasChild}}\n                        </div>\n                        {{/divide}}\n\n                    {{/items}}\n                </div>\n                <div class="ax-menu-arrow"></div>\n            </div>\n            '},this.__popup=function(t,a,u,s){var c,o=t;o.theme=t.theme||e.theme,o.cfg={icons:jQuery.extend({},e.icons),iconWidth:t.iconWidth||e.iconWidth,acceleratorWidth:t.acceleratorWidth||e.acceleratorWidth},o.items=a,o["@depth"]=u,o["@path"]=s||"root",o["@hasChild"]=function(){return this.items&&this.items.length>0},c=jQuery(ax5.mustache.render(this.__getTmpl(),o)),jQuery(document.body).append(c);var r=this.queue.splice(u);return r.forEach(function(e){e.$target.remove()}),this.queue.push({$target:c}),c.find("[data-menu-item-index]").bind("mouseover",function(){var i=this.getAttribute("data-menu-item-depth"),u=this.getAttribute("data-menu-item-index"),s=this.getAttribute("data-menu-item-path");if(c.find("[data-menu-item-index]").removeClass("hover"),jQuery(this).addClass("hover"),c.attr("data-selected-menu-item-index")!=u)if(c.attr("data-selected-menu-item-index",u),a[u].items&&a[u].items.length>0){var o=$(this),r=o.offset(),d={left:r.left+o.width()-e.menuBodyPadding,top:r.top-e.menuBodyPadding-1};d=jQuery.extend(!0,t,d),n.__popup(d,a[u].items,i+1,s)}else n.queue.splice(Number(i)+1).forEach(function(e){e.$target.remove()})}),0==u&&(jQuery(document).bind("click.ax5menu",function(t){var a=i.findParentNode(t.target,function(e){return e.getAttribute("data-menu-item-index")?!0:void 0});if(a){var u=function(e){var t;try{t=Function("","return this.config.items["+e.substring(5).replace(/\./g,"].items[")+"];").call(n)}catch(i){console.log(ax5.info.getError("ax5menu","501","menuItemClick"))}return t}(a.getAttribute("data-menu-item-path"));n.onClick&&(n.onClick.call(u,u),u.items&&0!=u.items.length||n.close()),e.onClick&&(e.onClick.call(u,u),u.items&&0!=u.items.length||n.close())}else n.close()}),jQuery(window).bind("keydown.ax5menu",function(e){e.which==ax5.info.eventKeys.ESC&&n.close()}),jQuery(window).bind("resize.ax5menu",function(e){n.close()})),this.__align(c,o),this},this.__align=function(e,t){return e.css({left:t.left,top:t.top}),this},this.popup=function(){var t={event:function(t,i){return t={left:t.clientX,top:t.clientY,width:e.width,theme:e.theme,direction:e.direction},i=jQuery.extend(!0,t,i)},object:function(t,i){return t={left:t.left,top:t.top,width:t.width||e.width,theme:t.theme||e.theme,direction:t.direction||e.direction},i=jQuery.extend(!0,t,i)}};return function(i,n){return i?(n=t["undefined"==typeof i.clientX?"object":"event"].call(this,i,n),this.__popup(n,e.items,0),this):this}}(),this.close=function(){return jQuery(document).unbind("click.ax5menu"),jQuery(window).unbind("keydown.ax5menu"),jQuery(window).unbind("resize.ax5menu"),this.queue.forEach(function(e){e.$target.remove()}),this.queue=[],this},this.main=function(){arguments&&i.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};e.menu=function(){return i.isFunction(t)&&(n.prototype=new t),n}()}(ax5.ui,ax5.ui.root);